@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    color-scheme: light;

    /* Light Neosonic surfaces */
    --color-bg-canvas: 214 56% 97%;
    --color-bg-subtle: 216 52% 95%;
    --color-bg-card: 0 0% 100%;
    --color-bg-elevated: 215 46% 92%;
    --color-bg-hover: 214 60% 90%;
    --color-bg-pressed: 214 66% 82%;

    --color-fg-default: 221 57% 11%;
    --color-fg-muted: 222 20% 38%;
    --color-fg-subtle: 222 14% 52%;
    --color-fg-on-accent: 210 40% 98%;

    --color-accent-default: 201 92% 55%;
    --color-accent-hover: 201 92% 50%;
    --color-accent-pressed: 201 92% 43%;
    --color-accent-subtle: 201 76% 92%;
    --color-accent-muted: 201 68% 78%;
    --color-accent-glow: 210 50% 60%;
    --color-accent-gradient-from: 210 40% 50%;
    --color-accent-gradient-to: 210 50% 45%;

    --color-stroke-divider: 216 33% 86%;
    --color-stroke-strong: 216 24% 70%;
    --color-stroke-focus: 200 94% 63%;

    --color-status-success: 158 64% 45%;
    --color-status-warning: 36 92% 55%;
    --color-status-danger: 345 85% 55%;
    --color-status-info: 201 92% 55%;

    --color-overlay-soft: 214 55% 90%;
    --color-overlay-strong: 210 45% 50%;

    --color-glass-surface: hsla(0, 0%, 100%, 0.78);
    --color-glass-hover: hsla(210, 56%, 94%, 0.92);
    --color-glass-border: hsla(213, 68%, 78%, 0.45);

    --shadow-color: 222 32% 16%;
    --shadow-glow: 210 50% 60%;
  }

  .dark {
    color-scheme: dark;

    --color-bg-canvas: 222 47% 11%;
    --color-bg-subtle: 223 44% 14%;
    --color-bg-card: 224 38% 18%;
    --color-bg-elevated: 223 38% 21%;
    --color-bg-hover: 223 42% 25%;
    --color-bg-pressed: 224 44% 30%;

    --color-fg-default: 214 38% 92%;
    --color-fg-muted: 220 18% 72%;
    --color-fg-subtle: 222 16% 60%;
    --color-fg-on-accent: 0 0% 100%;

    --color-accent-default: 201 92% 65%;
    --color-accent-hover: 201 92% 60%;
    --color-accent-pressed: 201 92% 52%;
    --color-accent-subtle: 223 42% 22%;
    --color-accent-muted: 210 35% 42%;
    --color-accent-glow: 210 55% 65%;
    --color-accent-gradient-from: 210 50% 60%;
    --color-accent-gradient-to: 210 45% 55%;

    --color-stroke-divider: 223 32% 26%;
    --color-stroke-strong: 223 32% 34%;
    --color-stroke-focus: 201 92% 65%;

    --color-status-success: 158 64% 52%;
    --color-status-warning: 36 92% 62%;
    --color-status-danger: 345 86% 62%;
    --color-status-info: 200 92% 64%;

    --color-overlay-soft: 223 38% 16%;
    --color-overlay-strong: 210 45% 55%;

    --color-glass-surface: hsla(223, 42%, 18%, 0.78);
    --color-glass-hover: hsla(223, 42%, 26%, 0.82);
    --color-glass-border: hsla(201, 92%, 65%, 0.35);

    --shadow-color: 222 55% 7%;
    --shadow-glow: 210 55% 65%;
  }

  * {
    @apply border-stroke-divider;
  }

  html {
    @apply scroll-smooth;
  }

  /* Use the app-level main container for scrolling; prevent document scroll */
  html,
  body,
  #__next {
    height: 100%;
    overflow: hidden !important;
  }

  body {
    @apply bg-bg-canvas text-fg-default font-sans antialiased;
    min-height: 100vh;
    background-color: hsl(var(--color-bg-canvas));
    background-image:
      radial-gradient(circle at 18% 20%, hsl(var(--color-accent-default) / 0.08), transparent 50%);
    background-attachment: fixed;
    font-feature-settings: 'rlig' 1, 'calt' 1;
  }

  .dark body {
    background-image:
      radial-gradient(circle at 15% 15%, hsl(var(--color-accent-default) / 0.12), transparent 50%);
  }

  ::selection {
    background-color: hsl(var(--color-accent-default) / 0.24);
    color: hsl(var(--color-fg-on-accent));
  }

  /* Focus outline */
  *:focus-visible {
    outline: 2px solid hsl(var(--color-stroke-focus));
    outline-offset: 3px;
    box-shadow: 0 0 0 6px hsl(var(--color-stroke-focus) / 0.18);
  }

  /* Reduce motion for accessibility */
  @media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
      scroll-behavior: auto !important;
    }
  }
}

@layer components {
  /* Loading spinner with Fluent design */
  .spinner {
    @apply animate-spin rounded-full h-4 w-4 border-2 border-stroke-divider border-t-accent;
  }

  /* Text truncation utility */
  .line-clamp-3 {
    line-clamp: 3;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
}

@layer utilities {
  /* Glassmorphism helpers */
  .glass-panel {
    background: var(--color-glass-surface);
    border: 1px solid var(--color-glass-border);
    backdrop-filter: blur(20px);
  }

  .glass-panel:hover {
    background: var(--color-glass-hover);
  }

  .focus-ring {
    box-shadow: 0 0 0 3px hsl(var(--color-stroke-focus) / 0.2);
  }

  /* Custom scrollbar styling (applied via .custom-scrollbar) */
  .custom-scrollbar {
    scrollbar-width: thin; /* Firefox */
    scrollbar-color: hsl(var(--color-stroke-divider)) transparent; /* Firefox */
  }

  .dark .custom-scrollbar {
    scrollbar-color: hsl(var(--color-stroke-strong)) transparent;
  }

  .custom-scrollbar::-webkit-scrollbar {
    width: 10px;
    height: 10px;
  }

  .custom-scrollbar::-webkit-scrollbar-track {
    background: transparent;
  }

  .custom-scrollbar::-webkit-scrollbar-thumb {
    background: hsl(var(--color-stroke-divider));
    border-radius: 8px;
    border: 2px solid hsl(var(--color-bg-canvas));
    transition: background-color 120ms ease, border-color 120ms ease;
  }

  .dark .custom-scrollbar::-webkit-scrollbar-thumb {
    background: hsl(var(--color-stroke-strong));
    border: 2px solid hsl(var(--color-bg-subtle));
  }

  .custom-scrollbar::-webkit-scrollbar-thumb:hover {
    background: hsl(var(--color-accent-muted));
    border-color: hsl(var(--color-bg-card));
  }

  .dark .custom-scrollbar::-webkit-scrollbar-thumb:hover {
    background: hsl(var(--color-accent-muted));
    border-color: hsl(var(--color-bg-elevated));
  }

  /* Narrow variant if needed */
  .custom-scrollbar.thin::-webkit-scrollbar {
    width: 6px;
  }

  /* Utility to visually hide scrollbars while preserving scroll behavior */
  .hide-scrollbar {
    -ms-overflow-style: none; /* IE and Edge */
    scrollbar-width: none; /* Firefox */
  }
  .hide-scrollbar::-webkit-scrollbar {
    display: none; /* Safari and Chrome */
  }
}